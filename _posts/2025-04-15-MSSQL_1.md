---
layout: single
title: "MSSQL Í∏∞Î≥∏ Í∞ÄÏù¥Îìú"
categories: TechNote
tags: [MSSQL, SQL Server, CRUD, SELECT, JOIN, CREATE, Í∏∞Î≥∏Î¨∏Î≤ï]
toc: true
toc_sticky: true
author_profile: true
---

# üìå MSSQLÏù¥ÎûÄ?

**MSSQL (Microsoft SQL Server)** Îäî ÎßàÏù¥ÌÅ¨Î°úÏÜåÌîÑÌä∏ÏóêÏÑú Ï†úÍ≥µÌïòÎäî Í¥ÄÍ≥ÑÌòï Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú(RDBMS)ÏûÖÎãàÎã§.
Í∏∞ÏóÖÏö©ÏúºÎ°ú ÎßéÏù¥ ÏÇ¨Ïö©ÎêòÎ©∞, SQL ÌëúÏ§ÄÏùÑ Í∏∞Î∞òÏúºÎ°ú ÌïòÎ©¥ÏÑúÎèÑ Í≥†Ïú†Ìïú Í∏∞Îä•(T-SQL Îì±)ÏùÑ Ìè¨Ìï®ÌïòÍ≥† ÏûàÏäµÎãàÎã§.

---

# ‚úÖ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Î∞è ÌÖåÏù¥Î∏î Í¥ÄÎ¶¨

## üîπ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÉùÏÑ± Î∞è ÏÑ†ÌÉù

```sql
CREATE DATABASE TestDB;
GO
USE TestDB;
GO
```

## üîπ ÌÖåÏù¥Î∏î ÏÉùÏÑ±

```sql
CREATE TABLE Users (
  Id INT PRIMARY KEY IDENTITY(1,1),
  Name NVARCHAR(100),
  Age INT
);
```

---

# ‚úÖ CRUD Í∏∞Î≥∏ Î¨∏Î≤ï

## üîπ INSERT (Îç∞Ïù¥ÌÑ∞ ÏÇΩÏûÖ)

```sql
INSERT INTO Users (Name, Age)
VALUES ('ÌôçÍ∏∏Îèô', 30);
```

## üîπ SELECT (Ï°∞Ìöå)

```sql
SELECT * FROM Users;
SELECT Name FROM Users WHERE Age > 25;
```

## üîπ UPDATE (ÏàòÏ†ï)

```sql
UPDATE Users SET Age = 31
WHERE Name = 'ÌôçÍ∏∏Îèô';
```

## üîπ DELETE (ÏÇ≠Ï†ú)

```sql
DELETE FROM Users WHERE Name = 'ÌôçÍ∏∏Îèô';
```

---

# ‚úÖ Í∏∞Î≥∏ Ìï®Ïàò Î∞è Ï†ïÎ†¨

## üîπ ÏßëÍ≥Ñ Ìï®Ïàò

```sql
SELECT COUNT(0) AS TotalUsers, AVG(Age) AS AverageAge FROM Users;
```

## üîπ Ï†ïÎ†¨ & ÌéòÏù¥Ïßï

```sql
SELECT * FROM Users ORDER BY Age DESC;

-- ÌéòÏù¥Ïßï (SQL Server 2012 Ïù¥ÏÉÅ)
SELECT *
FROM Users
ORDER BY Age
OFFSET 0 ROWS FETCH NEXT 10 ROWS ONLY;
```

---

# ‚úÖ ÌÖåÏù¥Î∏î Î≥µÏÇ¨

## üîπ Íµ¨Ï°∞ + Îç∞Ïù¥ÌÑ∞ Î≥µÏÇ¨

```sql
SELECT * INTO UsersCopy FROM Users;
```

## üîπ Íµ¨Ï°∞Îßå Î≥µÏÇ¨ (Îπà ÌÖåÏù¥Î∏î)

```sql
SELECT * INTO UsersTemplate FROM Users WHERE 1 = 0;
```

---

# ‚úÖ JOIN Î¨∏Î≤ï

## üîπ INNER JOIN

```sql
SELECT u.Name, o.OrderDate
FROM Users u
  INNER JOIN Orders o
    ON u.Id = o.UserId;
```

## üîπ LEFT JOIN

```sql
SELECT u.Name, o.OrderDate
FROM Users u
  LEFT JOIN Orders o
    ON u.Id = o.UserId;
```

## üîπ RIGHT JOIN

```sql
SELECT u.Name, o.OrderDate
FROM Users u
  RIGHT JOIN Orders o
    ON u.Id = o.UserId;
```

---

# ‚úÖ UPDATE/DELETE with JOIN

## üîπ JOINÏùÑ ÌÜµÌïú UPDATE

```sql
UPDATE o SET o.Status = 'Ï∑®ÏÜå'
FROM Orders o
  JOIN Users u
    ON o.UserId = u.Id
WHERE u.Name = 'ÌÖåÏä§Ìä∏';
```

## üîπ JOINÏùÑ ÌÜµÌïú DELETE

```sql
DELETE o
FROM Orders o
  JOIN Users u
    ON o.UserId = u.Id
WHERE u.Name = 'ÌÉàÌá¥ÌöåÏõê';
```

---

# ‚úÖ Í∏∞ÌÉÄ Ïú†Ïö©Ìïú Î¨∏Î≤ï

## üîπ NULL Ï≤òÎ¶¨ Ìï®Ïàò

```sql
SELECT ISNULL(PhoneNumber, 'ÏóÜÏùå') FROM Users;
```

## üîπ ÌòÑÏû¨ ÎÇ†Ïßú

```sql
SELECT GETDATE();
```

## üîπ Ï°∞Í±¥Î¨∏ (CASE)

```sql
SELECT Name,
  CASE
    WHEN Age >= 30 THEN 'ÏÑ±Ïù∏'
    ELSE 'Ï≤≠ÎÖÑ'
  END AS AgeGroup
FROM Users;
```
